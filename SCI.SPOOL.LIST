********************************************************************************
* Program: SCI.SPOOL.LIST
* Author : JMCGOWAN
* Date   : 2020-03-30
* Version: 2020-03-30
* Comment: List spooler settings for users
********************************************************************************
OPEN 'INFO-SYSTEM,DB.SECURITY' TO DB.SECURITY ELSE ABORT
OPEN 'SPOOLER.PARAMS' TO SPOOLER.PARAMS ELSE ABORT
OPEN 'DICT DB.SPOOLER' TO D.DB.SPOOLER ELSE ABORT
READ DEVICE.DATA FROM SPOOLER.PARAMS, 'DEVICE.DATA' ELSE ABORT
SELECT D.DB.SPOOLER
LOOP
  READNEXT ID ELSE EXIT
  READ SECURITY FROM DB.SECURITY, ID ELSE CONTINUE
  READ R FROM D.DB.SPOOLER, ID ELSE CONTINUE
  DEV=R<1>
  LOCATE DEV IN DEVICE.DATA<1> SETTING POS ELSE STOP DEV:' MISSING'
  CRT ID"L#12":POS"R#2":" ":DEVICE.DATA<2,POS>
REPEAT
CRT 'DONE'
*
